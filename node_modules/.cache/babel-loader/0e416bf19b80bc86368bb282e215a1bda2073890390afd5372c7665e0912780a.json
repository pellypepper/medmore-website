{"ast":null,"code":"import React,{useState,lazy,Suspense}from'react';import{BrowserRouter as Router,Route,Routes}from'react-router-dom';import{Elements}from'@stripe/react-stripe-js';import{loadStripe}from'@stripe/stripe-js';import'./App.css';import'bootstrap/dist/css/bootstrap.min.css';// Lazy load components\nimport{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const Home=/*#__PURE__*/lazy(()=>import('./pages/home/home'));const Payment=/*#__PURE__*/lazy(()=>import('./pages/payment/payment'));const Detail=/*#__PURE__*/lazy(()=>import('./pages/details/detail'));const Card=/*#__PURE__*/lazy(()=>import('./pages/card/card'));const ProductDisplay=/*#__PURE__*/lazy(()=>import('./pages/productdisplay/display'));const Checkout=/*#__PURE__*/lazy(()=>import('./pages/checkout/checkout'));const AdminDashboard=/*#__PURE__*/lazy(()=>import('./pages/adminDashboard/admin'));const OrderConfirmation=/*#__PURE__*/lazy(()=>import('./pages/order/order'));// Stripe configuration with error handling\nconst getStripe=()=>{const stripeKey='pk_test_51QRXGxBlRPuLLUxXv5sBy4qC8Fq0UlhZsF2B4fKZ2qjHiW9Ibf1ezKrM3cE25tPZlvGFZjDgdyBNh4D2Gp4G4QLYg00Az8G3Tzq';if(!stripeKey){console.error('Stripe public key is not defined in environment variables');return null;}try{return loadStripe(stripeKey);}catch(error){console.error('Error loading Stripe:',error);return null;}};const stripePromise=getStripe();// Error boundary for Stripe integration\nclass StripeErrorBoundary extends React.Component{constructor(props){super(props);this.state={hasError:false};}static getDerivedStateFromError(error){return{hasError:true};}componentDidCatch(error,errorInfo){console.error('Stripe Error:',error,errorInfo);}render(){if(this.state.hasError){return/*#__PURE__*/_jsx(\"div\",{children:\"Error loading payment system. Please try again later.\"});}return this.props.children;}}function App(){const[cart,setCart]=useState(()=>{const savedCart=sessionStorage.getItem(\"cart\");return savedCart?JSON.parse(savedCart):[];});const updateSessionStorageCart=newCart=>{if(newCart.length>0){sessionStorage.setItem(\"cart\",JSON.stringify(newCart));}else{sessionStorage.removeItem(\"cart\");}};const removeFromCart=async product=>{try{const newCart=cart.filter(item=>item.id!==product.productId);setCart(newCart);updateSessionStorageCart(newCart);const response=await fetch(`${process.env.REACT_APP_API_URL}/cart`,{method:\"DELETE\",headers:{\"Content-Type\":\"application/json\"},body:JSON.stringify({userId:sessionStorage.getItem(\"user_id\"),productId:product.productId})});if(!response.ok){throw new Error((await response.text())||\"Failed to remove item from cart\");}const serverCart=await response.json();setCart(serverCart);updateSessionStorageCart(serverCart);}catch(error){console.error(\"Error removing item from server:\",error);setCart(cart);updateSessionStorageCart(cart);}};// Only render Elements if Stripe is properly initialized\nconst renderStripeElements=()=>{if(!stripePromise){return/*#__PURE__*/_jsx(\"div\",{children:\"Unable to load payment system. Please check your configuration.\"});}return/*#__PURE__*/_jsx(Elements,{stripe:stripePromise,children:/*#__PURE__*/_jsx(Router,{children:/*#__PURE__*/_jsx(Suspense,{fallback:/*#__PURE__*/_jsx(\"div\",{children:\"Loading...\"}),children:/*#__PURE__*/_jsxs(Routes,{children:[/*#__PURE__*/_jsx(Route,{path:\"/\",element:/*#__PURE__*/_jsx(Home,{removeFromCart:removeFromCart})}),/*#__PURE__*/_jsx(Route,{path:\"/checkout\",element:/*#__PURE__*/_jsx(Checkout,{removeFromCart:removeFromCart})}),/*#__PURE__*/_jsx(Route,{path:\"/admin\",element:/*#__PURE__*/_jsx(AdminDashboard,{})}),/*#__PURE__*/_jsx(Route,{path:\"/payment\",element:/*#__PURE__*/_jsx(Payment,{})}),/*#__PURE__*/_jsx(Route,{path:\"/card\",element:/*#__PURE__*/_jsx(Card,{})}),/*#__PURE__*/_jsx(Route,{path:\"/detail\",element:/*#__PURE__*/_jsx(Detail,{})}),/*#__PURE__*/_jsx(Route,{path:\"/display\",element:/*#__PURE__*/_jsx(ProductDisplay,{})}),/*#__PURE__*/_jsx(Route,{path:\"/order\",element:/*#__PURE__*/_jsx(OrderConfirmation,{})})]})})})});};return/*#__PURE__*/_jsx(StripeErrorBoundary,{children:renderStripeElements()});}export default App;","map":{"version":3,"names":["React","useState","lazy","Suspense","BrowserRouter","Router","Route","Routes","Elements","loadStripe","jsx","_jsx","jsxs","_jsxs","Home","Payment","Detail","Card","ProductDisplay","Checkout","AdminDashboard","OrderConfirmation","getStripe","stripeKey","console","error","stripePromise","StripeErrorBoundary","Component","constructor","props","state","hasError","getDerivedStateFromError","componentDidCatch","errorInfo","render","children","App","cart","setCart","savedCart","sessionStorage","getItem","JSON","parse","updateSessionStorageCart","newCart","length","setItem","stringify","removeItem","removeFromCart","product","filter","item","id","productId","response","fetch","process","env","REACT_APP_API_URL","method","headers","body","userId","ok","Error","text","serverCart","json","renderStripeElements","stripe","fallback","path","element"],"sources":["C:/Users/ppeli/OneDrive/Documents/GitHub/medmore-website/src/App.js"],"sourcesContent":["import React, { useState, lazy, Suspense } from 'react';\r\nimport { BrowserRouter as Router, Route, Routes } from 'react-router-dom';\r\nimport { Elements } from '@stripe/react-stripe-js';\r\nimport { loadStripe } from '@stripe/stripe-js';\r\nimport './App.css';\r\nimport 'bootstrap/dist/css/bootstrap.min.css';\r\n\r\n// Lazy load components\r\nconst Home = lazy(() => import('./pages/home/home'));\r\nconst Payment = lazy(() => import('./pages/payment/payment'));\r\nconst Detail = lazy(() => import('./pages/details/detail'));\r\nconst Card = lazy(() => import('./pages/card/card'));\r\nconst ProductDisplay = lazy(() => import('./pages/productdisplay/display'));\r\nconst Checkout = lazy(() => import('./pages/checkout/checkout'));\r\nconst AdminDashboard = lazy(() => import('./pages/adminDashboard/admin'));\r\nconst OrderConfirmation = lazy(() => import('./pages/order/order'));\r\n\r\n// Stripe configuration with error handling\r\nconst getStripe = () => {\r\n  const stripeKey = 'pk_test_51QRXGxBlRPuLLUxXv5sBy4qC8Fq0UlhZsF2B4fKZ2qjHiW9Ibf1ezKrM3cE25tPZlvGFZjDgdyBNh4D2Gp4G4QLYg00Az8G3Tzq';\r\n  \r\n  if (!stripeKey) {\r\n    console.error('Stripe public key is not defined in environment variables');\r\n    return null;\r\n  }\r\n\r\n  try {\r\n    return loadStripe(stripeKey);\r\n  } catch (error) {\r\n    console.error('Error loading Stripe:', error);\r\n    return null;\r\n  }\r\n};\r\n\r\nconst stripePromise = getStripe();\r\n\r\n// Error boundary for Stripe integration\r\nclass StripeErrorBoundary extends React.Component {\r\n  constructor(props) {\r\n    super(props);\r\n    this.state = { hasError: false };\r\n  }\r\n\r\n  static getDerivedStateFromError(error) {\r\n    return { hasError: true };\r\n  }\r\n\r\n  componentDidCatch(error, errorInfo) {\r\n    console.error('Stripe Error:', error, errorInfo);\r\n  }\r\n\r\n  render() {\r\n    if (this.state.hasError) {\r\n      return <div>Error loading payment system. Please try again later.</div>;\r\n    }\r\n\r\n    return this.props.children;\r\n  }\r\n}\r\n\r\nfunction App() {\r\n  const [cart, setCart] = useState(() => {\r\n    const savedCart = sessionStorage.getItem(\"cart\");\r\n    return savedCart ? JSON.parse(savedCart) : [];\r\n  });\r\n\r\n  const updateSessionStorageCart = (newCart) => {\r\n    if (newCart.length > 0) {\r\n      sessionStorage.setItem(\"cart\", JSON.stringify(newCart));\r\n    } else {\r\n      sessionStorage.removeItem(\"cart\");\r\n    }\r\n  };\r\n\r\n  const removeFromCart = async (product) => {\r\n    try {\r\n      const newCart = cart.filter(item => item.id !== product.productId);\r\n      setCart(newCart);\r\n      updateSessionStorageCart(newCart);\r\n\r\n      const response = await fetch(`${process.env.REACT_APP_API_URL}/cart`, {\r\n        method: \"DELETE\",\r\n        headers: { \"Content-Type\": \"application/json\" },\r\n        body: JSON.stringify({\r\n          userId: sessionStorage.getItem(\"user_id\"),\r\n          productId: product.productId\r\n        }),\r\n      });\r\n\r\n      if (!response.ok) {\r\n        throw new Error(await response.text() || \"Failed to remove item from cart\");\r\n      }\r\n\r\n      const serverCart = await response.json();\r\n      setCart(serverCart);\r\n      updateSessionStorageCart(serverCart);\r\n\r\n    } catch (error) {\r\n      console.error(\"Error removing item from server:\", error);\r\n      setCart(cart);\r\n      updateSessionStorageCart(cart);\r\n    }\r\n  };\r\n\r\n  // Only render Elements if Stripe is properly initialized\r\n  const renderStripeElements = () => {\r\n    if (!stripePromise) {\r\n      return <div>Unable to load payment system. Please check your configuration.</div>;\r\n    }\r\n\r\n    return (\r\n      <Elements stripe={stripePromise}>\r\n        <Router>\r\n          <Suspense fallback={<div>Loading...</div>}>\r\n            <Routes>\r\n              <Route path=\"/\" element={<Home removeFromCart={removeFromCart} />} />\r\n              <Route path=\"/checkout\" element={<Checkout removeFromCart={removeFromCart} />} />\r\n              <Route path=\"/admin\" element={<AdminDashboard />} />\r\n              <Route path=\"/payment\" element={<Payment />} />\r\n              <Route path=\"/card\" element={<Card />} />\r\n              <Route path=\"/detail\" element={<Detail />} />\r\n              <Route path=\"/display\" element={<ProductDisplay />} />\r\n              <Route path=\"/order\" element={<OrderConfirmation />} />\r\n            </Routes>\r\n          </Suspense>\r\n        </Router>\r\n      </Elements>\r\n    );\r\n  };\r\n\r\n  return (\r\n    <StripeErrorBoundary>\r\n      {renderStripeElements()}\r\n    </StripeErrorBoundary>\r\n  );\r\n}\r\n\r\nexport default App;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}