{"ast":null,"code":"import React,{useState,lazy,Suspense}from'react';import{BrowserRouter as Router,Route,Routes}from'react-router-dom';import{Elements}from'@stripe/react-stripe-js';import{loadStripe}from'@stripe/stripe-js';import'./App.css';import'bootstrap/dist/css/bootstrap.min.css';// Lazy load components\nimport{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const Home=/*#__PURE__*/lazy(()=>import('./pages/home/home'));const Payment=/*#__PURE__*/lazy(()=>import('./pages/payment/payment'));const Detail=/*#__PURE__*/lazy(()=>import('./pages/details/detail'));const Card=/*#__PURE__*/lazy(()=>import('./pages/card/card'));const ProductDisplay=/*#__PURE__*/lazy(()=>import('./pages/productdisplay/display'));const Checkout=/*#__PURE__*/lazy(()=>import('./pages/checkout/checkout'));const AdminDashboard=/*#__PURE__*/lazy(()=>import('./pages/adminDashboard/admin'));const OrderConfirmation=/*#__PURE__*/lazy(()=>import('./pages/order/order'));// Stripe configuration with error handling\nconst getStripe=()=>{const stripeKey=process.env.REACT_APP_STRIPE_PUBLIC_KEY;if(!stripeKey){console.error('Stripe public key is not defined in environment variables');return null;}try{return loadStripe(stripeKey);}catch(error){console.error('Error loading Stripe:',error);return null;}};const stripePromise=getStripe();// Error boundary for Stripe integration\nclass StripeErrorBoundary extends React.Component{constructor(props){super(props);this.state={hasError:false};}static getDerivedStateFromError(error){return{hasError:true};}componentDidCatch(error,errorInfo){console.error('Stripe Error:',error,errorInfo);}render(){if(this.state.hasError){return/*#__PURE__*/_jsx(\"div\",{children:\"Error loading payment system. Please try again later.\"});}return this.props.children;}}function App(){const[cart,setCart]=useState(()=>{const savedCart=sessionStorage.getItem(\"cart\");return savedCart?JSON.parse(savedCart):[];});const updateSessionStorageCart=newCart=>{if(newCart.length>0){sessionStorage.setItem(\"cart\",JSON.stringify(newCart));}else{sessionStorage.removeItem(\"cart\");}};const removeFromCart=async product=>{try{const newCart=cart.filter(item=>item.id!==product.productId);setCart(newCart);updateSessionStorageCart(newCart);const response=await fetch(`${process.env.REACT_APP_API_URL}/cart`,{method:\"DELETE\",headers:{\"Content-Type\":\"application/json\"},body:JSON.stringify({userId:sessionStorage.getItem(\"user_id\"),productId:product.productId})});if(!response.ok){throw new Error((await response.text())||\"Failed to remove item from cart\");}const serverCart=await response.json();setCart(serverCart);updateSessionStorageCart(serverCart);}catch(error){console.error(\"Error removing item from server:\",error);setCart(cart);updateSessionStorageCart(cart);}};// Only render Elements if Stripe is properly initialized\nconst renderStripeElements=()=>{if(!stripePromise){return/*#__PURE__*/_jsx(\"div\",{children:\"Unable to load payment system. Please check your configuration.\"});}return/*#__PURE__*/_jsx(Elements,{stripe:stripePromise,children:/*#__PURE__*/_jsx(Router,{children:/*#__PURE__*/_jsx(Suspense,{fallback:/*#__PURE__*/_jsx(\"div\",{children:\"Loading...\"}),children:/*#__PURE__*/_jsxs(Routes,{children:[/*#__PURE__*/_jsx(Route,{path:\"/\",element:/*#__PURE__*/_jsx(Home,{removeFromCart:removeFromCart})}),/*#__PURE__*/_jsx(Route,{path:\"/checkout\",element:/*#__PURE__*/_jsx(Checkout,{removeFromCart:removeFromCart})}),/*#__PURE__*/_jsx(Route,{path:\"/admin\",element:/*#__PURE__*/_jsx(AdminDashboard,{})}),/*#__PURE__*/_jsx(Route,{path:\"/payment\",element:/*#__PURE__*/_jsx(Payment,{})}),/*#__PURE__*/_jsx(Route,{path:\"/card\",element:/*#__PURE__*/_jsx(Card,{})}),/*#__PURE__*/_jsx(Route,{path:\"/detail\",element:/*#__PURE__*/_jsx(Detail,{})}),/*#__PURE__*/_jsx(Route,{path:\"/display\",element:/*#__PURE__*/_jsx(ProductDisplay,{})}),/*#__PURE__*/_jsx(Route,{path:\"/order\",element:/*#__PURE__*/_jsx(OrderConfirmation,{})})]})})})});};return/*#__PURE__*/_jsx(StripeErrorBoundary,{children:renderStripeElements()});}export default App;","map":{"version":3,"names":["React","useState","lazy","Suspense","BrowserRouter","Router","Route","Routes","Elements","loadStripe","jsx","_jsx","jsxs","_jsxs","Home","Payment","Detail","Card","ProductDisplay","Checkout","AdminDashboard","OrderConfirmation","getStripe","stripeKey","process","env","REACT_APP_STRIPE_PUBLIC_KEY","console","error","stripePromise","StripeErrorBoundary","Component","constructor","props","state","hasError","getDerivedStateFromError","componentDidCatch","errorInfo","render","children","App","cart","setCart","savedCart","sessionStorage","getItem","JSON","parse","updateSessionStorageCart","newCart","length","setItem","stringify","removeItem","removeFromCart","product","filter","item","id","productId","response","fetch","REACT_APP_API_URL","method","headers","body","userId","ok","Error","text","serverCart","json","renderStripeElements","stripe","fallback","path","element"],"sources":["/Users/touchbar/Documents/GitHub/medmore-website/src/App.js"],"sourcesContent":["import React, { useState, lazy, Suspense } from 'react';\nimport { BrowserRouter as Router, Route, Routes } from 'react-router-dom';\nimport { Elements } from '@stripe/react-stripe-js';\nimport { loadStripe } from '@stripe/stripe-js';\nimport './App.css';\nimport 'bootstrap/dist/css/bootstrap.min.css';\n\n// Lazy load components\nconst Home = lazy(() => import('./pages/home/home'));\nconst Payment = lazy(() => import('./pages/payment/payment'));\nconst Detail = lazy(() => import('./pages/details/detail'));\nconst Card = lazy(() => import('./pages/card/card'));\nconst ProductDisplay = lazy(() => import('./pages/productdisplay/display'));\nconst Checkout = lazy(() => import('./pages/checkout/checkout'));\nconst AdminDashboard = lazy(() => import('./pages/adminDashboard/admin'));\nconst OrderConfirmation = lazy(() => import('./pages/order/order'));\n\n// Stripe configuration with error handling\nconst getStripe = () => {\n  const stripeKey = process.env.REACT_APP_STRIPE_PUBLIC_KEY;\n  \n  if (!stripeKey) {\n    console.error('Stripe public key is not defined in environment variables');\n    return null;\n  }\n\n  try {\n    return loadStripe(stripeKey);\n  } catch (error) {\n    console.error('Error loading Stripe:', error);\n    return null;\n  }\n};\n\nconst stripePromise = getStripe();\n\n// Error boundary for Stripe integration\nclass StripeErrorBoundary extends React.Component {\n  constructor(props) {\n    super(props);\n    this.state = { hasError: false };\n  }\n\n  static getDerivedStateFromError(error) {\n    return { hasError: true };\n  }\n\n  componentDidCatch(error, errorInfo) {\n    console.error('Stripe Error:', error, errorInfo);\n  }\n\n  render() {\n    if (this.state.hasError) {\n      return <div>Error loading payment system. Please try again later.</div>;\n    }\n\n    return this.props.children;\n  }\n}\n\nfunction App() {\n  const [cart, setCart] = useState(() => {\n    const savedCart = sessionStorage.getItem(\"cart\");\n    return savedCart ? JSON.parse(savedCart) : [];\n  });\n\n  const updateSessionStorageCart = (newCart) => {\n    if (newCart.length > 0) {\n      sessionStorage.setItem(\"cart\", JSON.stringify(newCart));\n    } else {\n      sessionStorage.removeItem(\"cart\");\n    }\n  };\n\n  const removeFromCart = async (product) => {\n    try {\n      const newCart = cart.filter(item => item.id !== product.productId);\n      setCart(newCart);\n      updateSessionStorageCart(newCart);\n\n      const response = await fetch(`${process.env.REACT_APP_API_URL}/cart`, {\n        method: \"DELETE\",\n        headers: { \"Content-Type\": \"application/json\" },\n        body: JSON.stringify({\n          userId: sessionStorage.getItem(\"user_id\"),\n          productId: product.productId\n        }),\n      });\n\n      if (!response.ok) {\n        throw new Error(await response.text() || \"Failed to remove item from cart\");\n      }\n\n      const serverCart = await response.json();\n      setCart(serverCart);\n      updateSessionStorageCart(serverCart);\n\n    } catch (error) {\n      console.error(\"Error removing item from server:\", error);\n      setCart(cart);\n      updateSessionStorageCart(cart);\n    }\n  };\n\n  // Only render Elements if Stripe is properly initialized\n  const renderStripeElements = () => {\n    if (!stripePromise) {\n      return <div>Unable to load payment system. Please check your configuration.</div>;\n    }\n\n    return (\n      <Elements stripe={stripePromise}>\n        <Router>\n          <Suspense fallback={<div>Loading...</div>}>\n            <Routes>\n              <Route path=\"/\" element={<Home removeFromCart={removeFromCart} />} />\n              <Route path=\"/checkout\" element={<Checkout removeFromCart={removeFromCart} />} />\n              <Route path=\"/admin\" element={<AdminDashboard />} />\n              <Route path=\"/payment\" element={<Payment />} />\n              <Route path=\"/card\" element={<Card />} />\n              <Route path=\"/detail\" element={<Detail />} />\n              <Route path=\"/display\" element={<ProductDisplay />} />\n              <Route path=\"/order\" element={<OrderConfirmation />} />\n            </Routes>\n          </Suspense>\n        </Router>\n      </Elements>\n    );\n  };\n\n  return (\n    <StripeErrorBoundary>\n      {renderStripeElements()}\n    </StripeErrorBoundary>\n  );\n}\n\nexport default App;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}