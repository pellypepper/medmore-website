"use strict";(self.webpackChunkfrontend=self.webpackChunkfrontend||[]).push([[288],{453:(e,t,s)=>{s.d(t,{A:()=>r});s(43);var a=s(579);const r=()=>(0,a.jsx)("aside",{className:"spinner-container",children:(0,a.jsx)("div",{className:"spinner"})})},288:(e,t,s)=>{s.r(t),s.d(t,{default:()=>l});var a=s(43),r=s(906),d=s(867),i=s(453),n=s(213),c=s(579);const l=()=>{const[e,t]=(0,a.useState)([]),[s,l]=(0,a.useState)(""),[o,u]=(0,a.useState)([]),[h,p]=(0,a.useState)({sales_count:0,total:0,total_buyer:0}),[m,_]=(0,a.useState)(!1),[j,x]=(0,a.useState)("Dashboard"),[S,E]=(0,a.useState)({id:"",name:"",price:"",image:null}),[T,P]=(0,a.useState)(!1),C=(0,a.useRef)(null),[g,v]=(0,a.useState)(!1),O=(0,r.Zp)(),[y,A]=(0,a.useState)(!1);(0,a.useEffect)((()=>{(async()=>{try{_(!0);const e=await fetch(`${{NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}.REACT_APP_API_URL}/products`),s=await e.json(),a=await fetch(`${{NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}.REACT_APP_API_URL}/sales`),r=await a.json(),d=await fetch(`${{NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}.REACT_APP_API_URL}/orders`),i=await d.json();u(s),p(r),t(i)}catch(e){console.error("Failed to fetch data",e)}finally{_(!1)}})()}),[]),(0,a.useEffect)((()=>{if(C.current&&C.current.destroy(),h.sales_count>0&&"Dashboard"===j){const e=document.getElementById("salesChart").getContext("2d");C.current=new d.Ay(e,{type:"line",data:{labels:["Jan","Feb","Mar","Apr","May"],datasets:[{label:"Sales ($)",data:[1200,1900,3e3,5e3,2400],borderColor:"rgba(75, 192, 192, 1)",backgroundColor:"rgba(75, 192, 192, 0.2)",tension:.4}]},options:{responsive:!0,plugins:{legend:{position:"top"}}}})}return()=>{C.current&&C.current.destroy()}}),[h,j]);const N=e=>{const{name:t,value:s}=e.target;E({...S,[t]:s})},R=e=>{E({id:e.id,name:e.name,price:e.price,image:null}),P(!0)},D=o.map((t=>{const s=e.reduce(((e,s)=>s.product_id===t.id?e+s.amount:e),0);return{...t,totalSales:s}})).sort(((e,t)=>t.totalSales-e.totalSales)).slice(0,5),b=e.reduce(((e,t)=>(e[t.payment_status]=(e[t.payment_status]||0)+1,e)),{});return(0,a.useEffect)((()=>{if(s){const e=setTimeout((()=>{v(!0)}),5e3);return()=>clearTimeout(e)}v(!1)}),[s]),m?(0,c.jsx)(i.A,{}):(0,c.jsxs)("div",{className:"admin-dashboard",children:[(0,c.jsxs)("aside",{className:"sidebar",children:[(0,c.jsx)("h2",{children:"Admin Dashboard"}),(0,c.jsxs)("ul",{children:[(0,c.jsx)("li",{onClick:()=>x("Dashboard"),className:"Dashboard"===j?"active":"",children:"Dashboard"}),(0,c.jsx)("li",{onClick:()=>x("Products"),className:"Products"===j?"active":"",children:"Products"}),(0,c.jsx)("li",{onClick:()=>x("Orders"),className:"Orders"===j?"active":"",children:"Orders"}),(0,c.jsx)("li",{onClick:async()=>{try{const e=await fetch(`${{NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}.REACT_APP_API_URL}/logout`,{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include"});if(!e.ok)throw new Error("Failed to log out");const t=await e.json();console.log(t.message),O("/")}catch(e){console.error("Logout error:",e),alert("Failed to log out. Please try again."),l("Failed to log out. Please try again.")}},className:"logout-button",children:"Logout"})]})]}),(0,c.jsxs)("main",{className:"dashboard-content",children:["Dashboard"===j&&(0,c.jsxs)(c.Fragment,{children:[(0,c.jsxs)("section",{className:"analytics",children:[(0,c.jsx)("h3",{className:"text-center my-3",children:"Analytics Overview"}),(0,c.jsxs)("div",{className:"analytics-cards mt-2",children:[(0,c.jsxs)("div",{className:"analytics-card",children:[(0,c.jsx)("h4",{children:"Total Revenue"}),(0,c.jsxs)("p",{children:["\xa3",h.total]})]}),(0,c.jsxs)("div",{className:"analytics-card",children:[(0,c.jsx)("h4",{children:"Total Orders"}),(0,c.jsx)("p",{children:h.sales_count})]}),(0,c.jsxs)("div",{className:"analytics-card",children:[(0,c.jsx)("h4",{children:"Total Customers"}),(0,c.jsx)("p",{children:h.total_buyer})]})]}),(0,c.jsxs)("div",{className:"order-summary",children:[(0,c.jsx)("h4",{children:"Order Summary by Status"}),(0,c.jsx)("ul",{children:Object.entries(b).map((e=>{let[t,s]=e;return(0,c.jsxs)("li",{children:[t,": ",s]},t)}))})]})]}),(0,c.jsxs)("section",{className:"chart",children:[(0,c.jsx)("h3",{children:"Sales Report"}),(0,c.jsx)("canvas",{id:"salesChart",width:"400",height:"200"})]}),(0,c.jsxs)("section",{className:"top-products",children:[(0,c.jsx)("h3",{children:"Top Selling Products"}),(0,c.jsx)("div",{className:"top-products-grid",children:D.map((e=>(0,c.jsxs)("div",{className:"top-product-card",children:[(0,c.jsx)("h4",{children:e.name}),(0,c.jsxs)("p",{className:"product-price",children:["Price: \xa3",e.price]}),(0,c.jsxs)("p",{className:"total-sales",children:["Total Sales: ",e.totalSales]}),(0,c.jsxs)("div",{className:"actions",children:[(0,c.jsx)("button",{className:"view-button",children:"View"}),(0,c.jsx)("button",{className:"edit-button",onClick:()=>R(e),children:"Edit"})]})]},e.id)))})]})]}),"Products"===j&&(0,c.jsxs)("section",{className:"products",children:[(0,c.jsx)("h3",{children:"Product List"}),(0,c.jsxs)("form",{onSubmit:T?async e=>{e.preventDefault(),A(!0);const t=new FormData;t.append("name",S.name),t.append("price",S.price),S.image&&t.append("image",S.image);for(const[a,r]of t.entries())console.log(`${a}:`,r);try{const e=await n.A.put(`${{NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}.REACT_APP_API_URL}/products/${S.id}`,t,{headers:{"Content-Type":"multipart/form-data"}});if(200!==e.status)throw new Error("Failed to update product");const s=e.data;u((e=>e.map((e=>e.id===s.id?s:e)))),E({id:"",name:"",price:"",image:null}),P(!1),l("Product Updated successfully!")}catch(s){console.error("Error updating product:",s)}finally{A(!1)}}:async e=>{if(e.preventDefault(),A(!0),!S.name||!S.price)return void alert("Please enter product name and price");if(!S.image)return void alert("Please select an image");const t=new FormData;t.append("image",S.image),t.append("name",S.name),t.append("price",S.price);try{const e=await n.A.post(`${{NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}.REACT_APP_API_URL}/products`,t,{headers:{"Content-Type":"multipart/form-data"}});u((t=>[...t,e.data])),E({id:"",name:"",price:"",image:null}),l("Product added successfully!")}catch(s){alert(),l(`Failed to add product: ${s.response?s.response.data.error:s.message}`)}finally{A(!1)}},children:[(0,c.jsx)("input",{type:"text",name:"name",placeholder:"Product Name",value:S.name,onChange:N,required:!0}),(0,c.jsx)("input",{type:"number",name:"price",placeholder:"Product Price",value:S.price,onChange:N,required:!0}),(0,c.jsx)("input",{type:"file",name:"image",placeholder:"Product Image",accept:"image/*",onChange:e=>{const t=e.target.files[0];t&&E((e=>({...e,image:t})))},required:!T}),(0,c.jsx)("button",{type:"submit",children:T?"Update Product":"Add Product"}),T&&(0,c.jsx)("button",{type:"button",onClick:()=>{E({id:"",name:"",price:"",img:null}),P(!1)},children:"Cancel"})]}),y&&(0,c.jsx)(i.A,{}),(0,c.jsx)("div",{className:"products-grid",children:o.map((e=>(0,c.jsxs)("div",{className:"product-card",children:[(0,c.jsx)("img",{loading:"lazy",src:e.img,alt:e.name}),(0,c.jsx)("h4",{children:e.name}),(0,c.jsxs)("p",{children:["Price: \xa3",e.price]}),(0,c.jsxs)("div",{className:"actions",children:[(0,c.jsx)("button",{onClick:()=>R(e),children:"Edit"}),(0,c.jsx)("button",{onClick:()=>(async e=>{try{if(!(await fetch(`${{NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}.REACT_APP_API_URL}/products/${e}`,{method:"DELETE"})).ok)throw new Error("Failed to delete product");u((t=>t.filter((t=>t.id!==e))))}catch(t){console.error("Error deleting product:",t)}})(e.id),children:"Delete"})]})]},e.id)))})]}),"Orders"===j&&(0,c.jsxs)("section",{className:"orders",children:[(0,c.jsx)("h3",{children:"Order List"}),e.length>0?(0,c.jsxs)("table",{className:"orders-table",children:[(0,c.jsx)("thead",{children:(0,c.jsxs)("tr",{children:[(0,c.jsx)("th",{children:"Order ID"}),(0,c.jsx)("th",{children:"Amount"}),(0,c.jsx)("th",{children:"Currency"}),(0,c.jsx)("th",{children:"Email"}),(0,c.jsx)("th",{children:"Address"}),(0,c.jsx)("th",{children:"Payment Status"}),(0,c.jsx)("th",{children:"Created At"}),(0,c.jsx)("th",{children:"Updated At"})]})}),(0,c.jsx)("tbody",{children:e.map((e=>(0,c.jsxs)("tr",{children:[(0,c.jsx)("td",{children:e.id}),(0,c.jsxs)("td",{children:["\xa3",e.amount]}),(0,c.jsx)("td",{children:e.currency}),(0,c.jsx)("td",{children:e.email}),(0,c.jsx)("td",{children:e.address}),(0,c.jsx)("td",{children:e.payment_status}),(0,c.jsx)("td",{children:new Date(e.created_at).toLocaleString()}),(0,c.jsx)("td",{children:new Date(e.updated_at).toLocaleString()})]},e.id)))})]}):(0,c.jsx)("p",{children:"No orders available."})]}),s&&(0,c.jsx)("div",{className:"alert-popup "+(g?"alert-popup-exit":""),children:s})]})]})}}}]);
//# sourceMappingURL=288.143fe0fe.chunk.js.map