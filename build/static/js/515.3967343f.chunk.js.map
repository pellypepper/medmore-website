{"version":3,"file":"static/js/515.3967343f.chunk.js","mappings":"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","sources":["component/spinner.js","pages/card/card.js"],"sourcesContent":["import React from \"react\";\r\nimport \"./spinner.css\"; \r\n\r\nconst Spinner = () => {\r\n    return (\r\n        <aside className=\"spinner-container\">\r\n            <div className=\"spinner\"></div>\r\n        </aside>\r\n    );\r\n};\r\n\r\nexport default Spinner;\r\n","import './card.css';\r\nimport React, { useState, useEffect } from 'react';\r\nimport { useStripe, useElements, CardNumberElement, CardExpiryElement, CardCvcElement } from '@stripe/react-stripe-js';\r\nimport { useLocation, useNavigate } from \"react-router-dom\";\r\nimport { FontAwesomeIcon } from '@fortawesome/react-fontawesome';\r\nimport { faCheckCircle, faExclamationCircle } from '@fortawesome/free-solid-svg-icons';\r\nimport Spinner from '../../component/spinner';\r\n\r\nconst Card = () => {\r\n    const [loading, setLoading] = useState(false);\r\n    const stripe = useStripe();\r\n    const elements = useElements();\r\n    const [error, setError] = useState(null);\r\n    const [paymentMethodType, setPaymentMethodType] = useState('card'); \r\n    const [alertMessage, setAlertMessage] = useState(\"\"); \r\n    const location = useLocation();\r\n    const total = location.state?.total || 0;\r\n    const form = location.state?.form || {};\r\n    const navigate = useNavigate();\r\n    const [fadeOut, setFadeOut] = useState(false);\r\n    const cart = location.state?.cart || [];\r\n\r\n\r\n    const handleSubmit = async (event) => {\r\n        event.preventDefault();\r\n        if (loading) return; // Prevent double clicks\r\n        setLoading(true);\r\n        setError(null);\r\n        setAlertMessage(\"\");\r\n\r\n        if (!stripe || !elements) {\r\n      \r\n            setLoading(false);\r\n            return;\r\n        }\r\n\r\n        try {\r\n\r\n            const response = await fetch(`${process.env.REACT_APP_API_URL}/payment/create-payment-intent`, {\r\n                method: 'POST',\r\n                headers: { 'Content-Type': 'application/json' },\r\n                body: JSON.stringify({ amount: total, paymentMethodType }),\r\n            });\r\n\r\n            if (!response.ok) {\r\n                throw new Error(`Failed to create payment intent: ${response.statusText}`);\r\n            }\r\n\r\n            const { clientSecret } = await response.json();\r\n            if (!clientSecret) {\r\n                throw new Error('Client secret is missing in the response.');\r\n            }\r\n\r\n\r\n\r\n            let confirmResult;\r\n\r\n            if (paymentMethodType === 'card') {\r\n                const cardNumberElement = elements.getElement(CardNumberElement);\r\n                const cardExpiryElement = elements.getElement(CardExpiryElement);\r\n                const cardCvcElement = elements.getElement(CardCvcElement);\r\n\r\n\r\n                if (!cardNumberElement || !cardExpiryElement || !cardCvcElement) {\r\n                    setError('Card elements are not available.');\r\n                    setLoading(false);\r\n                    return;\r\n                }\r\n\r\n                confirmResult = await stripe.confirmCardPayment(clientSecret, {\r\n                    payment_method: {\r\n                        card: cardNumberElement,\r\n                    },\r\n                });\r\n            } else if (['apple_pay', 'google_pay', 'klarna'].includes(paymentMethodType)) {\r\n              setError(`Payment method '${paymentMethodType}' is not yet supported.`);\r\n                setLoading(false);\r\n                return;\r\n            }\r\n\r\n            if (confirmResult && confirmResult.error) {\r\n\r\n                setError(confirmResult.error.message);\r\n            } else if (confirmResult && confirmResult.paymentIntent) {\r\n             \r\n                await sendUserDataToServer(form, confirmResult.paymentIntent.id, cart);\r\n                navigate('/order', {\r\n                    state: {\r\n                        order: {\r\n                            id: confirmResult.paymentIntent.id,\r\n                            total: total,\r\n                            email: form.email,\r\n                            items: cart.map(item => ({\r\n                                name: item.productName, // Ensure the property is correct\r\n                                quantity: item.quantity,\r\n                            })),\r\n                        },\r\n                    },\r\n                });\r\n            \r\n            } else {\r\n                      setError('An unexpected error occurred during payment confirmation.');\r\n            }\r\n        } catch (err) {\r\n\r\n            setError(err.message);\r\n        } finally {\r\n            setLoading(false); // Ensure loading state is turned off\r\n        }\r\n    };\r\n\r\n    const sendUserDataToServer = async (userData, paymentIntentId, cart) => {\r\n    \r\n        try {\r\n            const response = await fetch(`${process.env.REACT_APP_API_URL}/payment/record-payment`, {\r\n                method: 'POST',\r\n                headers: { 'Content-Type': 'application/json' },\r\n                body: JSON.stringify({ ...userData, paymentIntentId, cart }),\r\n            });\r\n    \r\n            if (!response.ok) {\r\n                throw new Error(`Failed to record payment: ${response.statusText}`);\r\n            }\r\n\r\n            const result = await response.json();\r\n            if (!result.success) {\r\n                throw new Error('Payment was not recorded successfully.');\r\n            }\r\n            setAlertMessage(` \"Payment recorded successfully!\" `);\r\n        } catch (error) {\r\n            console.error('Error recording payment:', error);\r\n            setError('Failed to record payment on server.');\r\n        }\r\n    };\r\n    \r\n\r\n    useEffect(() => {\r\n        if (alertMessage || error) {\r\n            const timer = setTimeout(() => {\r\n                setFadeOut(true); \r\n                const removeAlertTimer = setTimeout(() => {\r\n                    setAlertMessage(\"\"); \r\n                    setError(\"\");\r\n                    setFadeOut(false); \r\n                }, 500); \r\n\r\n                return () => clearTimeout(removeAlertTimer);\r\n            }, 5000); \r\n\r\n            return () => clearTimeout(timer); \r\n        }\r\n    }, [alertMessage, error]);\r\n\r\n  \r\n    \r\n\r\n    return (\r\n        <div className='card-section'>\r\n            <div className='card-wrapper'>\r\n                <div className='card-text'>\r\n                    <p>${total}</p>\r\n                    <p>Payment</p>\r\n                </div>\r\n\r\n                {loading && <Spinner />} \r\n                \r\n                <form className='mt-2' onSubmit={handleSubmit}>\r\n                    <label className='label'>\r\n                        Payment Method:\r\n                        <div className='payment-div'>\r\n                            <div>\r\n                                <input\r\n                                    type='radio'\r\n                                    onChange={(e) => setPaymentMethodType(e.target.value)}\r\n                                    name='paymentMethod'\r\n                                    value='card'\r\n                                    defaultChecked\r\n                                />\r\n                                <img src='card.webp' alt='card' /> Card\r\n                            </div>\r\n                            <div>\r\n                                <input\r\n                                    type='radio'\r\n                                    onChange={(e) => setPaymentMethodType(e.target.value)}\r\n                                    name='paymentMethod'\r\n                                    value='apple_pay'\r\n                                />\r\n                                <img src='apple.webp' alt='apple' /> Apple Pay\r\n                            </div>\r\n                            <div>\r\n                                <input\r\n                                    type='radio'\r\n                                    onChange={(e) => setPaymentMethodType(e.target.value)}\r\n                                    name='paymentMethod'\r\n                                    value='google_pay'\r\n                                />\r\n                                <img src='google.webp' alt='google' /> Google Pay\r\n                            </div>\r\n                            <div>\r\n                                <input\r\n                                    type='radio'\r\n                                    onChange={(e) => setPaymentMethodType(e.target.value)}\r\n                                    name='paymentMethod'\r\n                                    value='klarna'\r\n                                />\r\n                                <img src='klarna.webp' alt='klarna' /> Klarna\r\n                            </div>\r\n                        </div>\r\n                    </label>\r\n\r\n                    {paymentMethodType === 'card' && (\r\n                        <>\r\n                            <label htmlFor=\"card-number\">Card Number</label>\r\n                            <CardNumberElement\r\n                                id=\"card-number\"\r\n                                className=\"card-element full-width\"\r\n                                options={{\r\n                                    style: {\r\n                                        base: {\r\n                                            fontSize: '16px',\r\n                                            color: '#424770',\r\n                                            '::placeholder': {\r\n                                                color: '#aab7c4',\r\n                                            },\r\n                                        },\r\n                                        invalid: {\r\n                                            color: '#9e2146',\r\n                                        },\r\n                                    },\r\n                                }}\r\n                            />\r\n\r\n                            <label htmlFor=\"card-expiry\">Expiry Date</label>\r\n                            <CardExpiryElement\r\n                                id=\"card-expiry\"\r\n                                className=\"card-element\"\r\n                                options={{\r\n                                    style: {\r\n                                        base: {\r\n                                            fontSize: '16px',\r\n                                            color: '#424770',\r\n                                            '::placeholder': {\r\n                                                color: '#aab7c4',\r\n                                            },\r\n                                        },\r\n                                        invalid: {\r\n                                            color: '#9e2146',\r\n                                        },\r\n                                    },\r\n                                }}\r\n                            />\r\n\r\n                            <label htmlFor=\"card-cvc\">CVV</label>\r\n                            <CardCvcElement\r\n                                id=\"card-cvc\"\r\n                                className=\"card-element\"\r\n                                options={{\r\n                                    style: {\r\n                                        base: {\r\n                                            fontSize: '16px',\r\n                                            color: '#424770',\r\n                                            '::placeholder': {\r\n                                                color: '#aab7c4',\r\n                                            },\r\n                                        },\r\n                                        invalid: {\r\n                                            color: '#9e2146',\r\n                                        },\r\n                                    },\r\n                                }}\r\n                            />\r\n                        </>\r\n                    )}\r\n                    <button className='button' type=\"submit\" disabled={!stripe || loading}>\r\n                        {loading ? 'Processing...' : `Pay Now $${total}`}\r\n                    </button>\r\n                    {error && <div className='error'>{error}</div>}\r\n                </form>\r\n            </div>\r\n\r\n            {alertMessage && (\r\n                <div className={`success-popup ${fadeOut ? 'success-popup-exit' : ''}`}>\r\n                    <FontAwesomeIcon icon={faCheckCircle} color=\"green\" size=\"2x\" />\r\n                    <p>Payment Successful</p>\r\n                    <p>{alertMessage}</p>\r\n                </div>\r\n            )}\r\n\r\n            {error && (\r\n                <div className={`error ${fadeOut ? 'error-exit' : ''}`}>\r\n                    <FontAwesomeIcon icon={faExclamationCircle} color=\"red\" size=\"2x\" />\r\n                    <p>Payment Declined</p>\r\n                    <p>{error}</p>\r\n                    <button className='mt-1' onClick={() => setError('')}> Try Again</button>\r\n                </div>\r\n            )}\r\n        </div>\r\n    );\r\n};\r\n\r\nexport default Card;\r\n"],"names":["Spinner","_jsx","className","children","Card","_location$state","_location$state2","_location$state3","loading","setLoading","useState","stripe","useStripe","elements","useElements","error","setError","paymentMethodType","setPaymentMethodType","alertMessage","setAlertMessage","location","useLocation","total","state","form","navigate","useNavigate","fadeOut","setFadeOut","cart","sendUserDataToServer","async","userData","paymentIntentId","response","fetch","process","REACT_APP_API_URL","method","headers","body","JSON","stringify","ok","Error","statusText","json","success","console","useEffect","timer","setTimeout","removeAlertTimer","clearTimeout","_jsxs","onSubmit","event","preventDefault","amount","clientSecret","confirmResult","cardNumberElement","getElement","CardNumberElement","cardExpiryElement","CardExpiryElement","cardCvcElement","CardCvcElement","confirmCardPayment","payment_method","card","includes","message","paymentIntent","id","order","email","items","map","item","name","productName","quantity","err","type","onChange","e","target","value","defaultChecked","src","alt","_Fragment","htmlFor","options","style","base","fontSize","color","invalid","disabled","FontAwesomeIcon","icon","faCheckCircle","size","faExclamationCircle","onClick"],"sourceRoot":""}